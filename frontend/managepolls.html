<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">

    <style>
        .container {
            padding: 0px;
        }
    </style>

    <title>Voting App</title>
  </head>

  <body>

    <!-- jQuery --> <script src="https://code.jquery.com/jquery-3.1.1.js"></script>
    <!-- web3 --> <script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>
    <!-- Bootstrap --> <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js" integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf" crossorigin="anonymous"></script>

    <script>
      const web3 = new Web3('http://localhost:8545');
      const contractAddress = sessionStorage.getItem("contractAddress");
      const abi = [{"inputs":[{"internalType":"string","name":"proposal","type":"string"},{"internalType":"address","name":"chair","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},{"inputs":[{"internalType":"string","name":"newOption","type":"string"}],"name":"addNewOption","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"toAdd","type":"address"}],"name":"addNewVoter","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"getOptions","outputs":[{"internalType":"string[]","name":"","type":"string[]"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getQuestion","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getTotalVoted","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getTotalVoters","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"voteChoice","type":"string"}],"name":"vote","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"winningProposal","outputs":[{"internalType":"string[]","name":"","type":"string[]"}],"stateMutability":"view","type":"function"}];
      const myContract = new web3.eth.Contract(abi, contractAddress);
    </script>

    <div class="container">

      <br><br><br><br> <!-- Lazy way to add a top margin -->

      <div class="row justify-content-center">

          <div class="col-auto text-center">
              <h1>Manage Polls</h1>
          </div>
      </div> <!-- End row -->

      <hr><br>

      <div class="row">
          <div class="col">
              Select a poll question:

              <div class="dropdown">
                  <button class="btn btn-sm btn-secondary dropdown-toggle bg-light text-dark btn-outline-secondary" type="button" id="dropdownMenuButton1" data-bs-toggle="dropdown" aria-expanded="false">
                    
                  </button>
                  <ul class="dropdown-menu bg-light" aria-labelledby="dropdownMenuButton1">
                    <li><a class="dropdown-item" href="#">Poll question 1</a></li>
                    <li><a class="dropdown-item" href="#">Poll question 2</a></li>
                    <li><a class="dropdown-item" href="#">Poll question 3</a></li>
                  </ul>
                </div>

                <!-- Code to change dropdown button text -->
                <script>
                  // Set default selected member to the first member (which should be the chairman)
                  $(document).ready(function() {
                    $(".dropdown .dropdown-menu li a")[0].click();
                    
                    console.log($('#dropdownMenuButton1').text());
                  });

                  // Change the button text to the selected item
                  $(".dropdown-menu li a").click(function(){
                    $(this).parents(".dropdown").find('.btn').html($(this).text() + ' <span class="caret"></span>');
                    $(this).parents(".dropdown").find('.btn').val($(this).data('value'));
                    console.log($('#dropdownMenuButton1').text());
                  });

                </script>

          </div> <!-- End col -->

          <div class="col-8">
            <b> Voter Stats for current poll: </b>
            <br>
            *Add code for getTotalVoters()* <br>
            *Add code for getTotalVoted()*
          </div>
          
      </div> <!-- End row -->

      <br>

      <div class="row">
          <div class="col">
            <!-- Placeholder for formatting purposes -->
          </div> <!-- End col -->

          <div class="col-8">
            <b> Add new voter: </b> 
            <br>
            *Add code for addNewVoter()*
            <!-- Login -->
            <form>
              <div class="mb-3">
                <label for="newVoter" class="form-label"></label>
                <input class="form-control" id="newVoter">
                <br>
                <a type="submit" class="btn btn-sm btn-primary" placeholder="Enter new address" href="managepolls.html">Add</a>
              </div>
              
            </form> <!-- End login -->
          </div>
          
      </div> <!-- End row -->


    </div> <!-- End container -->

    <br><br><br>

    <footer class="bg-light text-center text-lg-start">
      <div class="text-center p-2 fixed-bottom" style="font-size: x-small;">
        <a class="btn btn-sm btn-light btn-outline-dark" href="index.html">Home</a>
        <br><br>
        <b>MIS 385N: Blockchain Solution Development / Smart Contracts</b>
        <br>
        Team 2 members: Alex Issa, Edward Hu, Ella Akl, InBae Chung, Palmer Wenzel, Yue Cheng
      </div>
    </footer>

  </body>
</html>